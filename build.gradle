repositories {
	mavenCentral()
	jcenter()
}

defaultTasks 'build'

configurations {
	tomcatLib { transitive = false }
	cloverLib { transitive = false }
	prometheus { transitive = false }
}

dependencies {
	cloverLib "javax.jms:javax.jms-api:2.0.1"
	
	tomcatLib "com.microsoft.sqlserver:sqljdbc4:4.0"
	tomcatLib "mysql:mysql-connector-java:5.1.47"
	tomcatLib "com.oracle:ojdbc6:11.2.0.3"
	tomcatLib "org.postgresql:postgresql:42.2.2.jre7"

	prometheus "io.prometheus.jmx:jmx_prometheus_javaagent:0.12.0"
}

task copyTomcatLib(type: Copy) {
	from configurations.tomcatLib
	into "var/dbdrivers"
}

task copyCloverLib(type: Copy) {
	from configurations.cloverLib
	into "var/clover-lib"
}

task copyPrometheusJmxAgent(type: Copy) {
	from configurations.prometheus
	into "examples/kubernetes"
}

// Logging
tasks.withType(Copy) {
	doFirst { logger.lifecycle("Copying files into {}:", projectDir.toPath().relativize(destinationDir.toPath())) }
	eachFile { logger.lifecycle("* {}", it.file.name) }
}

task build(dependsOn: [copyTomcatLib, copyCloverLib]) {
}